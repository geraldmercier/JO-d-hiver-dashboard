<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üëî Espace Manager ‚Äî JO d'Hiver</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="manager.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body class="manager-body">

    <header class="dashboard-header">
        <div class="header-container">
            <div class="header-logo">
                <span class="logo-icon">üëî</span>
                <div class="logo-text">
                    <h1>Espace Manager</h1>
                    <p id="nom-equipe-header">Chargement...</p>
                </div>
            </div>

            <div class="header-profil">
                <div id="dropdown-equipes-admin" style="display:none; margin-right:20px;">
                    <select id="select-equipe-admin" class="select-admin"></select>
                </div>
                
                <button class="btn-action" onclick="ouvrirModalChallenge()" style="margin-right:15px; background:#FF9800;">‚ö° Cr√©er Challenge</button>

                <div class="profil-info">
                    <h2 class="profil-nom" id="nom-manager">Chargement...</h2>
                    <p class="profil-equipe" id="role-manager">Manager</p>
                </div>
                <button class="btn-deconnexion" id="btn-deconnexion">Logout</button>
            </div>
        </div>
    </header>

    <main class="manager-main">
        <div class="dashboard-container">
            
            <section class="stats-grid">
                <div class="carte-stat">
                    <span class="stat-icon">üìÑ</span>
                    <div class="stat-data">
                        <div class="stat-valeur" id="stats-contrats-semaine">0</div>
                        <div class="stat-label">Contrats (7j)</div>
                    </div>
                </div>
                <div class="carte-stat">
                    <span class="stat-icon">üèÜ</span>
                    <div class="stat-data">
                        <div class="stat-valeur" id="stats-points-equipe">0</div>
                        <div class="stat-label">Points √âquipe</div>
                    </div>
                </div>
                <div class="carte-stat">
                    <span class="stat-icon">üì±</span>
                    <div class="stat-data">
                        <div class="stat-valeur" id="stats-taux-apiapp">0%</div>
                        <div class="stat-label">Taux ApiApp</div>
                    </div>
                </div>
            </section>

            <div class="manager-content-layout">
                <div class="colonne-validations">
                    <section class="carte">
                        <div class="section-header">
                            <h3 class="carte-titre">‚è≥ Contrats √† valider</h3>
                            <span class="badge-count" id="count-contrats">0</span>
                        </div>
                        <div id="liste-contrats-attente" class="liste-validation">
                            <div class="chargement">Recherche...</div>
                        </div>
                    </section>

                    <section class="carte">
                        <div class="section-header">
                            <h3 class="carte-titre">‚ö° Challenges √† valider</h3>
                            <span class="badge-count" id="count-challenges">0</span>
                        </div>
                        <div id="liste-challenges-attente" class="liste-validation"></div>
                    </section>
                </div>

                <div class="colonne-equipe">
                    <section class="carte">
                        <h3 class="carte-titre">üë• Mon √âquipe</h3>
                        <div id="liste-agents-equipe" class="liste-membres"></div>
                    </section>
                </div>
            </div>
        </div>
    </main>

    <div id="modal-challenge" class="modal">
        <div class="modal-content" style="text-align: left; max-width: 500px;">
            <h3>üöÄ Nouveau Challenge Flash</h3>
            <div class="form-groupe">
                <label>Titre</label>
                <input type="text" id="challenge-titre" placeholder="Ex: Sprint de l'apr√®s-midi">
            </div>
            <div class="form-groupe">
                <label>Points</label>
                <input type="number" id="challenge-points" value="10">
            </div>
            <div class="modal-actions">
                <button onclick="fermerModalChallenge()" class="btn-secondaire">Annuler</button>
                <button id="btn-submit-challenge" class="btn-primaire">Cr√©er le d√©fi</button>
            </div>
        </div>
    </div>

    <div id="modal-confirmation" class="modal">
        <div class="modal-content">
            <h3 id="modal-titre">Validation</h3>
            <p id="modal-message">Confirmer cette action ?</p>
            <div class="modal-actions">
                <button id="btn-modal-annuler" class="btn-secondaire">Non</button>
                <button id="btn-modal-confirmer" class="btn-primaire">Oui, Valider</button>
            </div>
        </div>
    </div>

    <style>
        .manager-content-layout { display: grid; grid-template-columns: 1fr 350px; gap: 20px; margin-top: 20px; }
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .carte-stat { background: white; padding: 20px; border-radius: 12px; display: flex; align-items: center; gap: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .stat-valeur { font-size: 24px; font-weight: bold; color: #1976D2; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); align-items: center; justify-content: center; }
        .modal-content { background: white; padding: 25px; border-radius: 15px; width: 90%; }
        .form-groupe { margin-bottom: 15px; }
        .form-groupe label { display: block; margin-bottom: 5px; font-weight: 600; }
        .form-groupe input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; }
        .liste-validation { display: flex; flex-direction: column; gap: 10px; }
    </style>

    <script src="config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="manager.js"></script> <script>
        // Petites fonctions pour g√©rer l'ouverture de la fen√™tre de challenge
        function ouvrirModalChallenge() { document.getElementById('modal-challenge').style.display = 'flex'; }
        function fermerModalChallenge() { document.getElementById('modal-challenge').style.display = 'none'; }
    </script>
</body>
</html>